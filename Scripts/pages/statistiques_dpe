import streamlit as st
import pandas as pd
import numpy as np

def show():
    st.markdown("## üìä Statistiques & Diagnostic de Performance √ânerg√©tique")
    
    # Section DPE
    st.markdown("### üè† Diagnostic de Performance √ânerg√©tique (DPE)")
    
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.markdown("""
        <div class="info-card">
            <h3>Qu'est-ce que le DPE ?</h3>
            <p>Le DPE est un diagnostic qui √©value la performance √©nerg√©tique d'un logement 
            en mesurant sa consommation d'√©nergie et son impact sur les √©missions de gaz √† effet de serre.</p>
        </div>
        """, unsafe_allow_html=True)
    
    with col2:
        st.markdown("""
        <div class="info-card">
            <h3>üìã Classes √ânerg√©tiques</h3>
            <p>
            A : Tr√®s performant<br>
            B : Performant<br>
            C : Assez performant<br>
            D : Moyennement performant<br>
            E : Peu performant<br>
            F : Tr√®s peu performant<br>
            G : Extr√™mement peu performant
            </p>
        </div>
        """, unsafe_allow_html=True)
    
    st.markdown("---")
    
    # Statistiques g√©n√©rales
    st.markdown("### üìà Statistiques Nationales")
    
    col1, col2, col3 = st.columns(3)
    
    with col1:
        st.metric("Consommation Moyenne", "250 kWh/m¬≤/an", "-5%")
    
    with col2:
        st.metric("Classe DPE Moyenne", "D", "Stable")
    
    with col3:
        st.metric("√âmissions Moyennes", "45 kg CO2/m¬≤/an", "-8%")
    
    st.markdown("---")
    
    # Filtre et analyse
    st.markdown("### üîç Analysez les Donn√©es")
    
    col1, col2, col3 = st.columns(3)
    
    with col1:
        region = st.selectbox("R√©gion", ["Auvergne-Rh√¥ne-Alpes", "√éle-de-France", "PACA", "Occitanie", "Nouvelle-Aquitaine"])
    
    with col2:
        type_logement = st.selectbox("Type de logement", ["Appartement", "Maison", "Bureau", "Commerce"])
    
    with col3:
        annee = st.selectbox("Ann√©e de construction", ["Avant 1948", "1948-1974", "1975-1989", "1990-2005", "Apr√®s 2005"])
    
    if st.button("Afficher les statistiques", type="primary"):
        st.success("‚úÖ Donn√©es charg√©es avec succ√®s")
        
        # Simulation de donn√©es
        data = {
            "Classe DPE": ["A", "B", "C", "D", "E", "F", "G"],
            "Nombre de logements": np.random.randint(100, 5000, 7),
            "% Total": np.random.randint(5, 30, 7)
        }
        df = pd.DataFrame(data)
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.markdown("#### R√©partition des Classes DPE")
            st.dataframe(df, use_container_width=True)
        
        with col2:
            st.markdown("#### Recommandations")
            st.markdown("""
            <div class="info-card">
                <p>‚Ä¢ 45% des logements n√©cessitent une r√©novation<br>
                ‚Ä¢ Potentiel d'√©conomie moyen : 850‚Ç¨/an<br>
                ‚Ä¢ R√©duction CO2 possible : 2.5 tonnes/an</p>
            </div>
            """, unsafe_allow_html=True)
